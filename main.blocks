<xml xmlns="https://developers.google.com/blockly/xml"><variables><variable id="GL1?dbU16V,BE52D!g2^">message</variable><variable id="Bbel$$oM!6wrI~^x{F}Q">mode</variable><variable id="PAvbGd~eYGc$JT7sR:C;">speed</variable></variables><block type="pxt-on-start" x="20" y="20"><statement name="HANDLER"><block type="typescript_statement" editable="false"><mutation xmlns="http://www.w3.org/1999/xhtml" line0="let mode = 0" numlines="1" declaredvars="mode"></mutation><next><block type="variables_set"><field name="VAR" id="PAvbGd~eYGc$JT7sR:C;">speed</field><value name="VALUE"><shadow type="math_number"><field name="NUM">50</field></shadow></value><next><block type="typescript_statement" editable="false"><mutation xmlns="http://www.w3.org/1999/xhtml" line0="enum MODE {" line1="    advance = 1, " line2="    back = 2," line3="    left = 3," line4="    right = 4," line5="    down = 5," line6="    up = 6," line7="    center = 7," line8="}" numlines="9"></mutation></block></next></block></next></block></statement></block><block type="function_definition" x="395" y="20"><mutation name="doServo" functionid="4bsLPHs=l3cD47+[0^-L"/><field name="function_name">doServo</field><comment pinned="false" h="80" w="160">サーボモータ動作処理&#10;モード変数に従いサーボモータを動作させる。</comment><statement name="STACK"><block type="typescript_statement" editable="false"><mutation xmlns="http://www.w3.org/1999/xhtml" line0="basic.showIcon(IconNames.Surprised, 0);" numlines="1"></mutation><next><block type="typescript_statement" editable="false"><mutation xmlns="http://www.w3.org/1999/xhtml" line0="switch (mode) {" line1="        case MODE.down:" line2="            maqueen.servoRun(maqueen.Servos.S1, 0);" line3="            break;" line4="        case MODE.up:" line5="            maqueen.servoRun(maqueen.Servos.S1, 180);" line6="            break;" line7="        case MODE.center:" line8="            maqueen.servoRun(maqueen.Servos.S1, 90);" line9="            break;" line10="    }" numlines="11"></mutation><next><block type="device_pause"><value name="pause"><shadow type="timePicker"><field name="ms">1000</field></shadow></value></block></next></block></next></block></statement></block><block type="IR_callbackUser" x="1032" y="20"><field name="HANDLER_message" id="GL1?dbU16V,BE52D!g2^">message</field><comment pinned="false" h="80" w="160">リモコン受信処理&#10;受信メッセージを動作モードとする。</comment><statement name="HANDLER"><block type="variables_set"><field name="VAR" id="Bbel$$oM!6wrI~^x{F}Q">mode</field><value name="VALUE"><shadow type="math_number"><field name="NUM">0</field></shadow><block type="variables_get"><field name="VAR" id="GL1?dbU16V,BE52D!g2^">message</field></block></value></block></statement></block><block type="device_forever" x="1467" y="20"><comment pinned="false" h="80" w="160">メイン処理&#10;モード変数に従い処理関数の呼び出しを行う。</comment><statement name="HANDLER"><block type="typescript_statement" editable="false"><mutation xmlns="http://www.w3.org/1999/xhtml" line0="basic.showIcon(IconNames.Asleep, 0);" numlines="1"></mutation><next><block type="typescript_statement" editable="false"><mutation xmlns="http://www.w3.org/1999/xhtml" line0="switch (mode) {" line1="        case MODE.advance:" line2="        case MODE.back:" line3="        case MODE.left:" line4="        case MODE.right:" line5="            doDrive(speed);" line6="            break;" line7="        case MODE.down:" line8="        case MODE.up:" line9="        case MODE.center:" line10="            doServo();" line11="            break;" line12="    }" numlines="13"></mutation></block></next></block></statement></block><block type="function_definition" x="1942" y="20"><mutation name="doDrive" functionid="Dgzos3T`l@4KTJda]@Yk"><arg name="speed" id="xlvc57e4hfg4yp1ygo6mj" type="number"/></mutation><field name="function_name">doDrive</field><comment pinned="false" h="80" w="160">モータ動作処理（引数は回転速度）&#10;モード変数に従いモーターを動作させる。</comment><value name="xlvc57e4hfg4yp1ygo6mj"><shadow type="argument_reporter_number"><field name="VALUE">speed</field></shadow></value><statement name="STACK"><block type="typescript_statement" editable="false"><mutation xmlns="http://www.w3.org/1999/xhtml" line0="basic.showIcon(IconNames.Happy, 0);" numlines="1"></mutation><next><block type="typescript_statement" editable="false"><mutation xmlns="http://www.w3.org/1999/xhtml" line0="switch (mode) {" line1="        case MODE.advance:" line2="            maqueen.motorRun(maqueen.Motors.All, maqueen.Dir.CW, speed);" line3="            break;" line4="        case MODE.back:" line5="            maqueen.motorRun(maqueen.Motors.All, maqueen.Dir.CCW, speed);" line6="            break;" line7="        case MODE.left:" line8="            maqueen.motorRun(maqueen.Motors.M1, maqueen.Dir.CW, speed);" line9="            maqueen.motorStop(maqueen.Motors.M2);" line10="            break;" line11="        case MODE.right:" line12="            maqueen.motorRun(maqueen.Motors.M2, maqueen.Dir.CW, speed);" line13="            maqueen.motorStop(maqueen.Motors.M1);" line14="            break;" line15="    }" numlines="16"></mutation></block></next></block></statement></block></xml>